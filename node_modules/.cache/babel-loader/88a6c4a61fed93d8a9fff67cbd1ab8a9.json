{"ast":null,"code":"import _objectSpread from\"D:/previous/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"D:/previous/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/previous/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\previous\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useCallback,useEffect,useState}from'react';import'./style.scss';import Icon from'react-icons-kit';import{Link}from'react-router-dom';import{plus,eye,edit2,trash2,x}from'react-icons-kit/feather';import{DataTable}from'../../components/table/Index';import{CustomButton}from'../../components/button';import{Container}from'../../components/container';import{Card}from'../../components/card/Index';import{formatDateWithAMPM}from'../../utils/Helpers';import{DeleteModal}from'../../components/modal/Delete';import{RangeFilter}from'../../components/rangeFilter/Index';import{SingleSelect}from'../../components/select';import Requests from'../../utils/Requests/Index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Index=function Index(){var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setLoading=_useState2[1];var _useState3=useState(10),_useState4=_slicedToArray(_useState3,2),limit=_useState4[0],setLimit=_useState4[1];var _useState5=useState(0),_useState6=_slicedToArray(_useState5,2),totalItems=_useState6[0],setTotalItems=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),data=_useState8[0],setData=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),closeFilter=_useState10[0],setCloseFilter=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),searchLoading=_useState12[0],setsearchLoading=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),isRangeFilterLoading=_useState14[0],setRangeFilterLoading=_useState14[1];var _useState15=useState({value:null,show:false,loading:false}),_useState16=_slicedToArray(_useState15,2),isDelete=_useState16[0],setDelete=_useState16[1];var _useState17=useState({headers:{Authorization:\"Bearer \"+localStorage.getItem('token')}}),_useState18=_slicedToArray(_useState17,1),header=_useState18[0];// Fetch data\nvar fetchData=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(page){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.next=3;return Requests.Coupon.Index(page,limit,header);case 3:response=_context.sent;if(response){setData(response.data);setTotalItems(response.pagination?response.pagination.items:0);}setLoading(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[limit,header]);var handlePageChange=function handlePageChange(page){return fetchData(page);};var handleLimitChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(newLimit,page){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(true);_context2.next=3;return Requests.Coupon.Index(page,newLimit,header);case 3:response=_context2.sent;setData(response.data);setLimit(newLimit);setLoading(false);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function handleLimitChange(_x2,_x3){return _ref2.apply(this,arguments);};}();useEffect(function(){fetchData(1);},[header,fetchData]);// Handle search\nvar handleSearch=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(data){var response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:setsearchLoading(true);_context3.next=3;return Requests.Coupon.Search(data,header);case 3:response=_context3.sent;if(response)setData(response.data);setsearchLoading(false);case 6:case\"end\":return _context3.stop();}}},_callee3);}));return function handleSearch(_x4){return _ref3.apply(this,arguments);};}();// Handle search suggestion\nvar handleSuggestion=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(value){var data,response,i,element;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:data={results:[],message:null};_context4.next=3;return Requests.Coupon.Search(value,header);case 3:response=_context4.sent;if(response&&response.data&&response.data.length){for(i=0;i<response.data.length;i++){element=response.data[i];data.results.push(element.name);}}else{data.message=\"No results found\";}return _context4.abrupt(\"return\",data);case 6:case\"end\":return _context4.stop();}}},_callee4);}));return function handleSuggestion(_x5){return _ref4.apply(this,arguments);};}();// Handle range filter\nvar handleRangeFilter=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data){var response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setRangeFilterLoading(true);setCloseFilter(true);_context5.next=4;return Requests.Coupon.DateRangeFilter(data,header);case 4:response=_context5.sent;setData(response.data);setRangeFilterLoading(false);case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function handleRangeFilter(_x6){return _ref5.apply(this,arguments);};}();// Handle selection\nvar handleItemSelection=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(data){var response;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:setLoading(true);setCloseFilter(true);_context6.next=4;return Requests.Coupon.Filter(data,header);case 4:response=_context6.sent;setData(response.data);setLoading(false);case 7:case\"end\":return _context6.stop();}}},_callee6);}));return function handleItemSelection(_x7){return _ref6.apply(this,arguments);};}();var columns=[{name:'Name',selector:function selector(row){return row.name;},sortable:true,grow:2},{name:'Code',selector:function selector(row){return row.code;},sortable:true},{name:'Type',selector:function selector(row){return row.type;},sortable:true},{name:'Amount',selector:function selector(row){return row.amount;},sortable:true},{name:'Price Discount',selector:function selector(row){return row.priceDiscount;},sortable:true},{name:'Valid Till',selector:function selector(row){return formatDateWithAMPM(row.validTill);},sortable:true,grow:2},{name:'Uses Limit',selector:function selector(row){return row.useLimit;},sortable:true},{name:'Assign TO',selector:function selector(row){return row.assignTo;},sortable:true},{name:'Action',grow:0,minWidth:'150px',cell:function cell(row){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard/coupon/\".concat(row._id,\"/show\"),children:/*#__PURE__*/_jsx(CustomButton,{style:{padding:\"6px 10px\"},className:\"btn-primary rounded-circle border-0\",children:/*#__PURE__*/_jsx(Icon,{icon:eye,size:16})})}),/*#__PURE__*/_jsx(Link,{to:\"/dashboard/coupon/\".concat(row._id,\"/edit\"),children:/*#__PURE__*/_jsx(CustomButton,{style:{padding:\"6px 10px\"},className:\"btn-success rounded-circle border-0 mx-1\",children:/*#__PURE__*/_jsx(Icon,{icon:edit2,size:16})})}),/*#__PURE__*/_jsx(CustomButton,{style:{padding:\"6px 10px\"},className:\"btn-danger rounded-circle border-0\",onClick:function onClick(){return setDelete({value:row,show:true});},children:/*#__PURE__*/_jsx(Icon,{icon:trash2,size:16})})]});}}];// Handle delete\nvar handleDelete=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:setDelete(_objectSpread(_objectSpread({},isDelete),{},{loading:true}));_context7.next=3;return Requests.Coupon.Delete(isDelete.value._id,header);case 3:fetchData();setDelete(_objectSpread(_objectSpread({},isDelete),{},{show:false,loading:false}));case 5:case\"end\":return _context7.stop();}}},_callee7);}));return function handleDelete(){return _ref7.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"pb-4\",children:[/*#__PURE__*/_jsx(Container.Fluid,{children:/*#__PURE__*/_jsx(Container.Row,{children:/*#__PURE__*/_jsx(Container.Column,{className:\"col-padding\",children:/*#__PURE__*/_jsxs(Card.Simple,{className:\"border-0\",children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"border-0 bg-white px-4 pt-4 pb-0\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h6\",{className:\"mb-0\",children:\"Coupon List\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto\",children:[/*#__PURE__*/_jsx(Link,{to:\"/dashboard/coupon/create\",children:/*#__PURE__*/_jsx(CustomButton,{className:\"btn-primary border-0 rounded-circle circle__padding\",children:/*#__PURE__*/_jsx(Icon,{icon:plus,size:22})})}),closeFilter?/*#__PURE__*/_jsx(CustomButton,{className:\"btn-danger border-0 rounded-circle circle__padding ml-1\",onClick:function onClick(){fetchData(1);setCloseFilter(false);},children:/*#__PURE__*/_jsx(Icon,{icon:x,size:22})}):null]})]}),/*#__PURE__*/_jsxs(Container.Row,{className:\"pt-2 px-2\",children:[/*#__PURE__*/_jsx(Container.Column,{className:\"col-md-6 col-xl-2 px-1 mb-2\",children:/*#__PURE__*/_jsx(SingleSelect,{placeholder:\"Type\",borderRadius:25,options:[{label:\"Flat\",value:\"Flat\"},{label:\"Percentage\",value:\"Percentage\"}],value:function value(event){return handleItemSelection({value:event.value,field:\"type\"});}})}),/*#__PURE__*/_jsx(Container.Column,{className:\"col-md-6 col-xl-2 px-1 mb-2\",children:/*#__PURE__*/_jsx(SingleSelect,{placeholder:\"Assign To\",borderRadius:25,options:[{label:\"Anything\",value:\"Anything\"},{label:\"Brand\",value:\"Brand\"},{label:\"Category\",value:\"Category\"},{label:\"Vendor\",value:\"Vendor\"},{label:\"Product\",value:\"Product\"},{label:\"Customer\",value:\"Customer\"}],value:function value(event){return handleItemSelection({value:event.value,field:\"assignTo\"});}})}),/*#__PURE__*/_jsx(Container.Column,{className:\"col-xl-8 px-1 mb-2\",children:/*#__PURE__*/_jsx(RangeFilter,{loading:isRangeFilterLoading,filter:handleRangeFilter})})]})]}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(DataTable,{fixedHeader:true,fixedHeaderScrollHeight:\"580px\",columns:columns,data:data,loading:isLoading,totalRows:totalItems,pagination:true,paginationServer:true,handlePerRowsChange:handleLimitChange,handlePageChange:handlePageChange,searchable:true,placeholder:\"Search coupon\",search:handleSearch,suggestion:handleSuggestion,searchLoading:searchLoading,clearSearch:function clearSearch(){return fetchData(1);}})})]})})})}),/*#__PURE__*/_jsx(DeleteModal,{show:isDelete.show,loading:isDelete.loading,message:/*#__PURE__*/_jsx(\"h6\",{children:\"Want to delete this coupon ?\"}),onHide:function onHide(){return setDelete({value:null,show:false,loading:false});},doDelete:handleDelete})]});};export default Index;","map":{"version":3,"sources":["D:/previous/src/pages/coupon/Index.js"],"names":["React","useCallback","useEffect","useState","Icon","Link","plus","eye","edit2","trash2","x","DataTable","CustomButton","Container","Card","formatDateWithAMPM","DeleteModal","RangeFilter","SingleSelect","Requests","Index","isLoading","setLoading","limit","setLimit","totalItems","setTotalItems","data","setData","closeFilter","setCloseFilter","searchLoading","setsearchLoading","isRangeFilterLoading","setRangeFilterLoading","value","show","loading","isDelete","setDelete","headers","Authorization","localStorage","getItem","header","fetchData","page","Coupon","response","pagination","items","handlePageChange","handleLimitChange","newLimit","handleSearch","Search","handleSuggestion","results","message","length","i","element","push","name","handleRangeFilter","DateRangeFilter","handleItemSelection","Filter","columns","selector","row","sortable","grow","code","type","amount","priceDiscount","validTill","useLimit","assignTo","minWidth","cell","_id","padding","handleDelete","Delete","label","event","field"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react'\nimport './style.scss'\nimport Icon from 'react-icons-kit'\nimport { Link } from 'react-router-dom'\nimport { plus, eye, edit2, trash2, x } from 'react-icons-kit/feather'\nimport { DataTable } from '../../components/table/Index'\nimport { CustomButton } from '../../components/button'\nimport { Container } from '../../components/container'\nimport { Card } from '../../components/card/Index'\nimport { formatDateWithAMPM } from '../../utils/Helpers'\n\nimport { DeleteModal } from '../../components/modal/Delete'\nimport { RangeFilter } from '../../components/rangeFilter/Index'\nimport { SingleSelect } from '../../components/select'\n\nimport Requests from '../../utils/Requests/Index'\n\nconst Index = () => {\n    const [isLoading, setLoading] = useState(true)\n    const [limit, setLimit] = useState(10)\n    const [totalItems, setTotalItems] = useState(0)\n\n    const [data, setData] = useState([])\n    const [closeFilter, setCloseFilter] = useState(false)\n    const [searchLoading, setsearchLoading] = useState(false)\n    const [isRangeFilterLoading, setRangeFilterLoading] = useState(false)\n    const [isDelete, setDelete] = useState({ value: null, show: false, loading: false })\n    const [header] = useState({\n        headers: { Authorization: \"Bearer \" + localStorage.getItem('token') }\n    })\n\n    // Fetch data\n    const fetchData = useCallback(async (page) => {\n        setLoading(true)\n        const response = await Requests.Coupon.Index(page, limit, header)\n\n        if (response) {\n            setData(response.data)\n            setTotalItems(response.pagination ? response.pagination.items : 0)\n        }\n        setLoading(false)\n    }, [limit, header])\n\n    const handlePageChange = page => fetchData(page)\n\n    const handleLimitChange = async (newLimit, page) => {\n        setLoading(true)\n        const response = await Requests.Coupon.Index(page, newLimit, header)\n\n        setData(response.data)\n        setLimit(newLimit)\n        setLoading(false)\n    }\n\n    useEffect(() => {\n        fetchData(1)\n    }, [header, fetchData])\n\n    // Handle search\n    const handleSearch = async data => {\n        setsearchLoading(true)\n        const response = await Requests.Coupon.Search(data, header)\n        if (response) setData(response.data)\n        setsearchLoading(false)\n    }\n\n    // Handle search suggestion\n    const handleSuggestion = async (value) => {\n        let data = {\n            results: [],\n            message: null\n        }\n        const response = await Requests.Coupon.Search(value, header)\n\n        if (response && response.data && response.data.length) {\n            for (let i = 0; i < response.data.length; i++) {\n                const element = response.data[i]\n                data.results.push(element.name)\n            }\n        } else {\n            data.message = \"No results found\"\n        }\n\n        return data\n    }\n\n    // Handle range filter\n    const handleRangeFilter = async (data) => {\n        setRangeFilterLoading(true)\n        setCloseFilter(true)\n        const response = await Requests.Coupon.DateRangeFilter(data, header)\n        setData(response.data)\n        setRangeFilterLoading(false)\n    }\n\n    // Handle selection\n    const handleItemSelection = async data => {\n        setLoading(true)\n        setCloseFilter(true)\n        const response = await Requests.Coupon.Filter(data, header)\n\n        setData(response.data)\n        setLoading(false)\n    }\n\n    const columns = [\n        {\n            name: 'Name',\n            selector: row => row.name,\n            sortable: true,\n            grow: 2\n        },\n        {\n            name: 'Code',\n            selector: row => row.code,\n            sortable: true\n        },\n        {\n            name: 'Type',\n            selector: row => row.type,\n            sortable: true\n        },\n        {\n            name: 'Amount',\n            selector: row => row.amount,\n            sortable: true\n        },\n        {\n            name: 'Price Discount',\n            selector: row => row.priceDiscount,\n            sortable: true\n        },\n        {\n            name: 'Valid Till',\n            selector: row => formatDateWithAMPM(row.validTill),\n            sortable: true,\n            grow: 2\n        },\n        {\n            name: 'Uses Limit',\n            selector: row => row.useLimit,\n            sortable: true\n        },\n        {\n            name: 'Assign TO',\n            selector: row => row.assignTo,\n            sortable: true\n        },\n        {\n            name: 'Action',\n            grow: 0,\n            minWidth: '150px',\n            cell: row =>\n                <div>\n                    <Link to={`/dashboard/coupon/${row._id}/show`}>\n                        <CustomButton\n                            style={{ padding: \"6px 10px\" }}\n                            className=\"btn-primary rounded-circle border-0\"\n                        ><Icon icon={eye} size={16} />\n                        </CustomButton>\n                    </Link>\n\n                    <Link to={`/dashboard/coupon/${row._id}/edit`}>\n                        <CustomButton\n                            style={{ padding: \"6px 10px\" }}\n                            className=\"btn-success rounded-circle border-0 mx-1\"\n                        ><Icon icon={edit2} size={16} />\n                        </CustomButton>\n                    </Link>\n\n                    <CustomButton\n                        style={{ padding: \"6px 10px\" }}\n                        className=\"btn-danger rounded-circle border-0\"\n                        onClick={() => setDelete({ value: row, show: true })}\n                    ><Icon icon={trash2} size={16} />\n                    </CustomButton>\n                </div>\n        }\n    ]\n\n    // Handle delete\n    const handleDelete = async () => {\n        setDelete({ ...isDelete, loading: true })\n\n        await Requests.Coupon.Delete(isDelete.value._id, header)\n        fetchData()\n        setDelete({ ...isDelete, show: false, loading: false })\n    }\n\n    return (\n        <div className=\"pb-4\">\n            <Container.Fluid>\n                <Container.Row>\n                    <Container.Column className=\"col-padding\">\n                        <Card.Simple className=\"border-0\">\n                            <Card.Header className=\"border-0 bg-white px-4 pt-4 pb-0\">\n\n                                {/* title container */}\n                                <div className=\"d-flex\">\n                                    <div><h6 className=\"mb-0\">Coupon List</h6></div>\n                                    <div className=\"ml-auto\">\n                                        <Link to=\"/dashboard/coupon/create\">\n                                            <CustomButton className=\"btn-primary border-0 rounded-circle circle__padding\">\n                                                <Icon icon={plus} size={22} />\n                                            </CustomButton>\n                                        </Link>\n\n                                        {closeFilter ?\n                                            <CustomButton\n                                                className=\"btn-danger border-0 rounded-circle circle__padding ml-1\"\n                                                onClick={() => {\n                                                    fetchData(1)\n                                                    setCloseFilter(false)\n                                                }}\n                                            >\n                                                <Icon icon={x} size={22} />\n                                            </CustomButton>\n                                            : null\n                                        }\n                                    </div>\n                                </div>\n\n                                {/* Filter container */}\n                                <Container.Row className=\"pt-2 px-2\">\n\n                                    {/* Type */}\n                                    <Container.Column className=\"col-md-6 col-xl-2 px-1 mb-2\">\n                                        <SingleSelect\n                                            placeholder=\"Type\"\n                                            borderRadius={25}\n                                            options={[{ label: \"Flat\", value: \"Flat\" }, { label: \"Percentage\", value: \"Percentage\" }]}\n                                            value={event => handleItemSelection({ value: event.value, field: \"type\" })}\n                                        />\n                                    </Container.Column>\n\n                                    {/* Assign To */}\n                                    <Container.Column className=\"col-md-6 col-xl-2 px-1 mb-2\">\n                                        <SingleSelect\n                                            placeholder=\"Assign To\"\n                                            borderRadius={25}\n                                            options={[\n                                                { label: \"Anything\", value: \"Anything\" },\n                                                { label: \"Brand\", value: \"Brand\" },\n                                                { label: \"Category\", value: \"Category\" },\n                                                { label: \"Vendor\", value: \"Vendor\" },\n                                                { label: \"Product\", value: \"Product\" },\n                                                { label: \"Customer\", value: \"Customer\" }\n                                            ]}\n                                            value={event => handleItemSelection({ value: event.value, field: \"assignTo\" })}\n                                        />\n                                    </Container.Column>\n\n                                    {/* Date range filter */}\n                                    <Container.Column className=\"col-xl-8 px-1 mb-2\">\n                                        <RangeFilter\n                                            loading={isRangeFilterLoading}\n                                            filter={handleRangeFilter}\n                                        />\n                                    </Container.Column>\n                                </Container.Row>\n                            </Card.Header>\n                            <Card.Body className=\"p-0\">\n                                <DataTable\n                                    fixedHeader\n                                    fixedHeaderScrollHeight=\"580px\"\n                                    columns={columns}\n                                    data={data}\n                                    loading={isLoading}\n                                    totalRows={totalItems}\n                                    pagination={true}\n                                    paginationServer={true}\n                                    handlePerRowsChange={handleLimitChange}\n                                    handlePageChange={handlePageChange}\n\n                                    searchable\n                                    placeholder={\"Search coupon\"}\n                                    search={handleSearch}\n                                    suggestion={handleSuggestion}\n                                    searchLoading={searchLoading}\n                                    clearSearch={() => fetchData(1)}\n                                />\n                            </Card.Body>\n                        </Card.Simple>\n                    </Container.Column>\n                </Container.Row>\n            </Container.Fluid>\n\n            {/* Delete confirmation */}\n            <DeleteModal\n                show={isDelete.show}\n                loading={isDelete.loading}\n                message={<h6>Want to delete this coupon ?</h6>}\n                onHide={() => setDelete({ value: null, show: false, loading: false })}\n                doDelete={handleDelete}\n            />\n        </div>\n    );\n}\n\nexport default Index;\n"]},"metadata":{},"sourceType":"module"}