{"ast":null,"code":"import _asyncToGenerator from\"D:/previous/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"D:/previous/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"D:\\\\previous\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useCallback,useEffect,useState}from'react';import'./style.scss';import Icon from'react-icons-kit';import{x}from'react-icons-kit/feather';import{Link}from'react-router-dom';import{DataTable}from'../../../components/table/Index';import{RangeFilter}from'../../../components/rangeFilter/Index';import{Container}from'../../../components/container';import{Card}from'../../../components/card/Index';import{SearchableSelect}from'../../../components/select';import{CustomButton}from'../../../components/button';import Requests from'../../../utils/Requests/Index';import ExportCSV from'../../../components/exportCSV/Index';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Index=function Index(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isFilter=_useState2[0],setFilter=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setLoading=_useState4[1];var _useState5=useState(10),_useState6=_slicedToArray(_useState5,2),limit=_useState6[0],setLimit=_useState6[1];var _useState7=useState(0),_useState8=_slicedToArray(_useState7,2),totalItems=_useState8[0],setTotalItems=_useState8[1];var _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),data=_useState10[0],setData=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),sheetData=_useState12[0],setSheetData=_useState12[1];var _useState13=useState(false),_useState14=_slicedToArray(_useState13,2),closeFilter=_useState14[0],setCloseFilter=_useState14[1];var _useState15=useState({headers:{Authorization:\"Bearer \"+localStorage.getItem('token')}}),_useState16=_slicedToArray(_useState15,1),header=_useState16[0];// Fetch data\nvar fetchData=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(page){var response,xlsxData,i,element;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setLoading(true);_context.next=3;return Requests.BestSale.Index(page,limit,header);case 3:response=_context.sent;if(response){xlsxData=[];setData(response.data);setTotalItems(response.pagination?response.pagination.items:0);if(response.data&&response.data.length){for(i=0;i<response.data.length;i++){element=response.data[i];xlsxData.push({name:element.name,sku:element.sku,sales_time:element.salesTime,sales_quantity:element.salesQuantity});}setSheetData(xlsxData);}}setLoading(false);case 6:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}(),[limit,header]);useEffect(function(){fetchData(1);},[header,fetchData]);// handle page change\nvar handlePageChange=function handlePageChange(page){return fetchData(page);};// handle limit change\nvar handleLimitChange=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(newLimit,page){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:setLoading(true);_context2.next=3;return Requests.BestSale.Index(page,newLimit,header);case 3:response=_context2.sent;setData(response.data);setLimit(newLimit);setLoading(false);case 7:case\"end\":return _context2.stop();}}},_callee2);}));return function handleLimitChange(_x2,_x3){return _ref2.apply(this,arguments);};}();// handle filter fields\nvar handleFilterField=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(_ref3){var inputValue,field,response;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:inputValue=_ref3.inputValue,field=_ref3.field;if(!field)response={data:[]};if(!(field===\"vendor\")){_context3.next=6;break;}_context3.next=5;return Requests.Options.Vendor(inputValue,header);case 5:response=_context3.sent;case 6:if(!(field===\"brand\")){_context3.next=10;break;}_context3.next=9;return Requests.Options.Brand(inputValue,header);case 9:response=_context3.sent;case 10:if(!(field===\"leaf-category\")){_context3.next=14;break;}_context3.next=13;return Requests.Options.LeafCategory(inputValue,header);case 13:response=_context3.sent;case 14:if(!(response.data&&response.data.length)){_context3.next=16;break;}return _context3.abrupt(\"return\",response.data);case 16:return _context3.abrupt(\"return\",[]);case 17:case\"end\":return _context3.stop();}}},_callee3);}));return function handleFilterField(_x4){return _ref4.apply(this,arguments);};}();// Handle filter by selected item\nvar filterBySelectedItem=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(data){var response;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:setLoading(true);setCloseFilter(true);_context4.next=4;return Requests.BestSale.FilterByFields(data,header);case 4:response=_context4.sent;setData(response.data);setLoading(false);case 7:case\"end\":return _context4.stop();}}},_callee4);}));return function filterBySelectedItem(_x5){return _ref5.apply(this,arguments);};}();// FIlter items\nvar handleFilterByDate=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(data){var response;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:setFilter(true);setCloseFilter(true);_context5.next=4;return Requests.BestSale.FilterByDate(data,header);case 4:response=_context5.sent;setData(response.data);setFilter(false);case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function handleFilterByDate(_x6){return _ref6.apply(this,arguments);};}();// data coulmns\nvar columns=[{name:'Product',sortable:true,grow:1,minWidth:'300px',cell:function cell(row){return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"my-2\",children:/*#__PURE__*/_jsx(Link,{to:\"/dashboard/product/\".concat(row._id,\"/show\"),children:row.name&&row.name.length>40?row.name.slice(0,40)+' ...':row.name})}),/*#__PURE__*/_jsxs(\"p\",{className:\"mb-2\",children:[/*#__PURE__*/_jsx(\"b\",{children:\"SKU: \"}),row.sku]})]});}},{name:'Brand',sortable:true,selector:function selector(row){return row.brand;}},{name:'Vendor',sortable:true,selector:function selector(row){return row.vendor;}},{name:'Leaf-Category',sortable:true,selector:function selector(row){return row.leafCategory;}},{name:'Sales Time',sortable:true,selector:function selector(row){return row.salesTime;}},{name:'Sales Qunt.',sortable:true,selector:function selector(row){return row.salesQuantity;}}];return/*#__PURE__*/_jsx(\"div\",{className:\"pb-4\",children:/*#__PURE__*/_jsx(Container.Fluid,{children:/*#__PURE__*/_jsx(Container.Row,{children:/*#__PURE__*/_jsx(Container.Column,{className:\"col-padding\",children:/*#__PURE__*/_jsxs(Card.Simple,{className:\"border-0\",children:[/*#__PURE__*/_jsxs(Card.Header,{className:\"bg-white border-0 p-3 p-lg-4\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"d-flex\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"h6\",{className:\"mt-0 mb-3\",children:\"Best selling products.\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"ml-auto\",children:/*#__PURE__*/_jsx(ExportCSV,{csvData:sheetData,fileName:'Best_selling_products'})}),closeFilter?/*#__PURE__*/_jsx(CustomButton,{className:\"btn-danger border-0 rounded-circle circle__padding ml-2\",onClick:function onClick(){fetchData(1);setCloseFilter(false);},children:/*#__PURE__*/_jsx(Icon,{icon:x,size:22})}):null]}),/*#__PURE__*/_jsxs(Container.Row,{className:\"pt-2 px-2\",children:[/*#__PURE__*/_jsx(Container.Column,{className:\"col-6 col-sm-4 col-xl-2 px-1 mb-2\",children:/*#__PURE__*/_jsx(SearchableSelect,{isMulti:false,placeholder:\"Vendor\",search:function search(inputValue){return handleFilterField({inputValue:inputValue,field:\"vendor\"});},values:function values(event){return filterBySelectedItem({value:event.value,field:\"vendor\"});}})}),/*#__PURE__*/_jsx(Container.Column,{className:\"col-6 col-sm-4 col-xl-2 px-1 mb-2\",children:/*#__PURE__*/_jsx(SearchableSelect,{isMulti:false,placeholder:\"Brand\",search:function search(inputValue){return handleFilterField({inputValue:inputValue,field:\"brand\"});},values:function values(event){return filterBySelectedItem({value:event.value,field:\"brand\"});}})}),/*#__PURE__*/_jsx(Container.Column,{className:\"col-6 col-sm-4 col-xl-2 px-1 mb-2\",children:/*#__PURE__*/_jsx(SearchableSelect,{isMulti:false,placeholder:\"Leaf-Category\",search:function search(inputValue){return handleFilterField({inputValue:inputValue,field:\"leaf-category\"});},values:function values(event){return filterBySelectedItem({value:event.value,field:\"leaf-category\"});}})}),/*#__PURE__*/_jsx(Container.Column,{className:\"col-xl-6 px-1 mb-2\",children:/*#__PURE__*/_jsx(RangeFilter,{loading:isFilter,filter:handleFilterByDate})})]})]}),/*#__PURE__*/_jsx(Card.Body,{className:\"p-0\",children:/*#__PURE__*/_jsx(DataTable,{fixedHeader:true,fixedHeaderScrollHeight:\"580px\",columns:columns,data:data,loading:isLoading,totalRows:totalItems,pagination:true,paginationServer:true,handlePerRowsChange:handleLimitChange,handlePageChange:handlePageChange})})]})})})})});};export default Index;","map":{"version":3,"sources":["D:/previous/src/pages/reports/bestSales/Index.js"],"names":["React","useCallback","useEffect","useState","Icon","x","Link","DataTable","RangeFilter","Container","Card","SearchableSelect","CustomButton","Requests","ExportCSV","Index","isFilter","setFilter","isLoading","setLoading","limit","setLimit","totalItems","setTotalItems","data","setData","sheetData","setSheetData","closeFilter","setCloseFilter","headers","Authorization","localStorage","getItem","header","fetchData","page","BestSale","response","xlsxData","pagination","items","length","i","element","push","name","sku","sales_time","salesTime","sales_quantity","salesQuantity","handlePageChange","handleLimitChange","newLimit","handleFilterField","inputValue","field","Options","Vendor","Brand","LeafCategory","filterBySelectedItem","FilterByFields","handleFilterByDate","FilterByDate","columns","sortable","grow","minWidth","cell","row","_id","slice","selector","brand","vendor","leafCategory","event","value"],"mappings":"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","sourcesContent":["import React, { useCallback, useEffect, useState } from 'react'\nimport './style.scss'\nimport Icon from 'react-icons-kit'\nimport { x } from 'react-icons-kit/feather'\nimport { Link } from 'react-router-dom'\nimport { DataTable } from '../../../components/table/Index'\nimport { RangeFilter } from '../../../components/rangeFilter/Index'\nimport { Container } from '../../../components/container'\nimport { Card } from '../../../components/card/Index'\nimport { SearchableSelect } from '../../../components/select'\nimport { CustomButton } from '../../../components/button'\n\nimport Requests from '../../../utils/Requests/Index'\nimport ExportCSV from '../../../components/exportCSV/Index'\n\nconst Index = () => {\n    const [isFilter, setFilter] = useState(false)\n    const [isLoading, setLoading] = useState(true)\n    const [limit, setLimit] = useState(10)\n    const [totalItems, setTotalItems] = useState(0)\n\n    const [data, setData] = useState([])\n    const [sheetData, setSheetData] = useState([])\n    const [closeFilter, setCloseFilter] = useState(false)\n    const [header] = useState({\n        headers: { Authorization: \"Bearer \" + localStorage.getItem('token') }\n    })\n\n    // Fetch data\n    const fetchData = useCallback(async (page) => {\n        setLoading(true)\n        const response = await Requests.BestSale.Index(page, limit, header)\n\n        if (response) {\n            let xlsxData = []\n            setData(response.data)\n            setTotalItems(response.pagination ? response.pagination.items : 0)\n\n            if (response.data && response.data.length) {\n                for (let i = 0; i < response.data.length; i++) {\n                    const element = response.data[i]\n                    xlsxData.push({\n                        name: element.name,\n                        sku: element.sku,\n                        sales_time: element.salesTime,\n                        sales_quantity: element.salesQuantity\n                    })\n                }\n                setSheetData(xlsxData)\n            }\n        }\n\n        setLoading(false)\n    }, [limit, header])\n\n    useEffect(() => {\n        fetchData(1)\n    }, [header, fetchData])\n\n    // handle page change\n    const handlePageChange = page => fetchData(page)\n\n    // handle limit change\n    const handleLimitChange = async (newLimit, page) => {\n        setLoading(true)\n        const response = await Requests.BestSale.Index(page, newLimit, header)\n\n        setData(response.data)\n        setLimit(newLimit)\n        setLoading(false)\n    }\n\n    // handle filter fields\n    const handleFilterField = async ({ inputValue, field }) => {\n        let response\n\n        if (!field) response = { data: [] }\n        if (field === \"vendor\") response = await Requests.Options.Vendor(inputValue, header)\n        if (field === \"brand\") response = await Requests.Options.Brand(inputValue, header)\n        if (field === \"leaf-category\") response = await Requests.Options.LeafCategory(inputValue, header)\n\n        if (response.data && response.data.length) return response.data\n        return []\n    }\n\n    // Handle filter by selected item\n    const filterBySelectedItem = async data => {\n        setLoading(true)\n        setCloseFilter(true)\n        const response = await Requests.BestSale.FilterByFields(data, header)\n\n        setData(response.data)\n        setLoading(false)\n    }\n\n    // FIlter items\n    const handleFilterByDate = async data => {\n        setFilter(true)\n        setCloseFilter(true)\n        const response = await Requests.BestSale.FilterByDate(data, header)\n        setData(response.data)\n        setFilter(false)\n    }\n\n    // data coulmns\n    const columns = [\n        {\n            name: 'Product',\n            sortable: true,\n            grow: 1,\n            minWidth: '300px',\n            cell: row =>\n                <div>\n                    <p className=\"my-2\"><Link to={`/dashboard/product/${row._id}/show`}>{row.name && row.name.length > 40 ? row.name.slice(0, 40) + ' ...' : row.name}</Link></p>\n                    <p className=\"mb-2\"><b>SKU: </b>{row.sku}</p>\n                </div>\n        },\n        {\n            name: 'Brand',\n            sortable: true,\n            selector: row => row.brand\n        },\n        {\n            name: 'Vendor',\n            sortable: true,\n            selector: row => row.vendor\n        },\n        {\n            name: 'Leaf-Category',\n            sortable: true,\n            selector: row => row.leafCategory\n        },\n        {\n            name: 'Sales Time',\n            sortable: true,\n            selector: row => row.salesTime\n        },\n        {\n            name: 'Sales Qunt.',\n            sortable: true,\n            selector: row => row.salesQuantity\n        }\n    ]\n\n    return (\n        <div className=\"pb-4\">\n            <Container.Fluid>\n                <Container.Row>\n                    <Container.Column className=\"col-padding\">\n                        <Card.Simple className=\"border-0\">\n                            <Card.Header className=\"bg-white border-0 p-3 p-lg-4\">\n\n                                {/* page header */}\n                                <div className=\"d-flex\">\n                                    <div>\n                                        <h6 className=\"mt-0 mb-3\">Best selling products.</h6>\n                                    </div>\n                                    <div className=\"ml-auto\">\n                                        <ExportCSV\n                                            csvData={sheetData}\n                                            fileName={'Best_selling_products'}\n                                        />\n                                    </div>\n\n                                    {closeFilter ?\n                                        <CustomButton\n                                            className=\"btn-danger border-0 rounded-circle circle__padding ml-2\"\n                                            onClick={() => {\n                                                fetchData(1)\n                                                setCloseFilter(false)\n                                            }}\n                                        >\n                                            <Icon icon={x} size={22} />\n                                        </CustomButton>\n                                        : null\n                                    }\n                                </div>\n\n                                {/* filter items conatiner */}\n                                <Container.Row className=\"pt-2 px-2\">\n\n                                    {/* Vendor */}\n                                    <Container.Column className=\"col-6 col-sm-4 col-xl-2 px-1 mb-2\">\n                                        <SearchableSelect\n                                            isMulti={false}\n                                            placeholder=\"Vendor\"\n                                            search={inputValue => handleFilterField({ inputValue, field: \"vendor\" })}\n                                            values={event => filterBySelectedItem({ value: event.value, field: \"vendor\" })}\n                                        />\n                                    </Container.Column>\n\n                                    {/* Brand */}\n                                    <Container.Column className=\"col-6 col-sm-4 col-xl-2 px-1 mb-2\">\n                                        <SearchableSelect\n                                            isMulti={false}\n                                            placeholder=\"Brand\"\n                                            search={inputValue => handleFilterField({ inputValue, field: \"brand\" })}\n                                            values={event => filterBySelectedItem({ value: event.value, field: \"brand\" })}\n                                        />\n                                    </Container.Column>\n\n                                    {/* Leaf-Category */}\n                                    <Container.Column className=\"col-6 col-sm-4 col-xl-2 px-1 mb-2\">\n                                        <SearchableSelect\n                                            isMulti={false}\n                                            placeholder=\"Leaf-Category\"\n                                            search={inputValue => handleFilterField({ inputValue, field: \"leaf-category\" })}\n                                            values={event => filterBySelectedItem({ value: event.value, field: \"leaf-category\" })}\n                                        />\n                                    </Container.Column>\n\n                                    {/* Range filter */}\n                                    <Container.Column className=\"col-xl-6 px-1 mb-2\">\n                                        <RangeFilter\n                                            loading={isFilter}\n                                            filter={handleFilterByDate}\n                                        />\n                                    </Container.Column>\n\n                                </Container.Row>\n                            </Card.Header>\n                            <Card.Body className=\"p-0\">\n                                <DataTable\n                                    fixedHeader\n                                    fixedHeaderScrollHeight=\"580px\"\n                                    columns={columns}\n                                    data={data}\n                                    loading={isLoading}\n                                    totalRows={totalItems}\n                                    pagination={true}\n                                    paginationServer={true}\n                                    handlePerRowsChange={handleLimitChange}\n                                    handlePageChange={handlePageChange}\n                                />\n                            </Card.Body>\n                        </Card.Simple>\n                    </Container.Column>\n                </Container.Row>\n            </Container.Fluid>\n        </div>\n    );\n};\n\nexport default Index;"]},"metadata":{},"sourceType":"module"}